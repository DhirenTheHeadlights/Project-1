\doxysection{Player\+Ship\+Movement\+Handler\+\_\+\+PG.\+cpp}
\hypertarget{_player_ship_movement_handler___p_g_8cpp_source}{}\label{_player_ship_movement_handler___p_g_8cpp_source}\index{C:/Users/Dhiren/source/repos/DhirenTheHeadlights/Project-\/1/PirateGame/Resource/PlayerShipMovementHandler\_PG.cpp@{C:/Users/Dhiren/source/repos/DhirenTheHeadlights/Project-\/1/PirateGame/Resource/PlayerShipMovementHandler\_PG.cpp}}
\mbox{\hyperlink{_player_ship_movement_handler___p_g_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_player_ship_movement_handler___p_g_8h}{PlayerShipMovementHandler\_PG.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00003}00003\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespace_pirate_game}{PirateGame}};}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00005}00005\ \textcolor{comment}{//\ Move\ the\ ship}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00006}\mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_ad6ce0e94877aa23b691d854fb48579f2_ad6ce0e94877aa23b691d854fb48579f2}{00006}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_ad6ce0e94877aa23b691d854fb48579f2_ad6ce0e94877aa23b691d854fb48579f2}{PlayerShipMovementHandler::move}}(\textcolor{keywordtype}{float}\ baseSpeed)\ \{}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00007}00007\ \ \ \ \ \textcolor{comment}{//\ Initialize\ the\ map}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00008}00008\ \ \ \ \ sf::Vector2f\ map\ =\ \mbox{\hyperlink{class_pirate_game_1_1_global_map_a1ffb02317c3441081d1bda96b69a27bd_a1ffb02317c3441081d1bda96b69a27bd}{GlobalMap::getInstance}}().\mbox{\hyperlink{class_pirate_game_1_1_global_map_a31cc006b6de67f683e4d07a88a18987a_a31cc006b6de67f683e4d07a88a18987a}{getWorldMap}}();}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00009}00009\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a8f8d30cbbfeab3b82af844e14a9348a5_a8f8d30cbbfeab3b82af844e14a9348a5}{setBaseSpeed}}(\mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a25aa9fa07cfc0b374ca13add9684ee97_a25aa9fa07cfc0b374ca13add9684ee97}{baseSpeed}});}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00011}00011\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a95a5d40338d075f36b9a86def829dfc5_a95a5d40338d075f36b9a86def829dfc5}{setInitialPosition}}();}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00013}00013\ \ \ \ \ \textcolor{keywordtype}{float}\ elapsed\ =\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_ad298d2920d7d5dedf621d13b9fcdffa2_ad298d2920d7d5dedf621d13b9fcdffa2}{getDeltaTime}}().restart().asSeconds();}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00015}00015\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ direction\ based\ on\ the\ ship's\ current\ rotation}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00016}00016\ \ \ \ \ \textcolor{keywordtype}{float}\ rotationInRadians\ =\ (\mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a11e4f9226cb35705bfff3d612ca40e97_a11e4f9226cb35705bfff3d612ca40e97}{getSprite}}().getRotation()\ -\/\ 90.f)\ *\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_ad00b1e5a061c541252c823ae9925535f_ad00b1e5a061c541252c823ae9925535f}{pi}}\ /\ 180.f;\ \textcolor{comment}{//\ Subtract\ 90\ degrees\ to\ align\ with\ SFML's\ rotation}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00017}00017\ \ \ \ \ sf::Vector2f\ direction(std::cos(rotationInRadians),\ std::sin(rotationInRadians));}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00019}00019\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a75d1275722138cfe2c3b121e4c4a4ef9_a75d1275722138cfe2c3b121e4c4a4ef9}{updateVelocity}}(direction,\ elapsed,\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a25aa9fa07cfc0b374ca13add9684ee97_a25aa9fa07cfc0b374ca13add9684ee97}{baseSpeed}});}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00020}00020\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_a81c98b333191598a26a49f3f05f4182d_a81c98b333191598a26a49f3f05f4182d}{setSpriteRotation}}();}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00021}00021\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a6b8a7eafd522cce76d6ca7749709deeb_a6b8a7eafd522cce76d6ca7749709deeb}{applyBoundaryConstraints}}(\mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_ae3f6ba0f881c5327195167a6f098b6e9_ae3f6ba0f881c5327195167a6f098b6e9}{position}},\ map);}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00023}00023\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ new\ position}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00024}00024\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a11e4f9226cb35705bfff3d612ca40e97_a11e4f9226cb35705bfff3d612ca40e97}{getSprite}}().setPosition(\mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_ae3f6ba0f881c5327195167a6f098b6e9_ae3f6ba0f881c5327195167a6f098b6e9}{position}});}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00025}00025\ \}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00028}\mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_a81c98b333191598a26a49f3f05f4182d_a81c98b333191598a26a49f3f05f4182d}{00028}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_a81c98b333191598a26a49f3f05f4182d_a81c98b333191598a26a49f3f05f4182d}{PlayerShipMovementHandler::setSpriteRotation}}()\ \{}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a8bfb82ba8f436cc8bbbb36f619697775_a8bfb82ba8f436cc8bbbb36f619697775}{getIsColliding}}()\ ||\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_aec10c664bbd63d3b65510391a6dc3e4b_aec10c664bbd63d3b65510391a6dc3e4b}{getStopShipRotationFlag}}())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00031}00031\ \ \ \ \ \textcolor{comment}{//\ Grab\ window}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00032}00032\ \ \ \ \ sf::RenderWindow*\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a5853b7a5e11f286af2f9491da290fbd3_a5853b7a5e11f286af2f9491da290fbd3}{window}}\ =\ \mbox{\hyperlink{class_pirate_game_1_1_global_values_a40abd855ad2ca0e405e066ec43502a97_a40abd855ad2ca0e405e066ec43502a97}{GlobalValues::getInstance}}().\mbox{\hyperlink{class_pirate_game_1_1_global_values_ac0271b79e8e02295ca8095a22bfb0ae2_ac0271b79e8e02295ca8095a22bfb0ae2}{getWindow}}();}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00034}00034\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ direction\ to\ the\ mouse}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00035}00035\ \ \ \ \ sf::Vector2f\ mousePosition\ =\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a5853b7a5e11f286af2f9491da290fbd3_a5853b7a5e11f286af2f9491da290fbd3}{window}}-\/>mapPixelToCoords(sf::Mouse::getPosition(*\mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a5853b7a5e11f286af2f9491da290fbd3_a5853b7a5e11f286af2f9491da290fbd3}{window}}));}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00036}00036\ \ \ \ \ sf::Vector2f\ directionToMouse\ =\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a060b2c8469300f147c387d5814844114_a060b2c8469300f147c387d5814844114}{normalize}}(mousePosition\ -\/\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a11e4f9226cb35705bfff3d612ca40e97_a11e4f9226cb35705bfff3d612ca40e97}{getSprite}}().getPosition());}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00038}00038\ \ \ \ \ \textcolor{comment}{//\ Rotate\ the\ sprite\ using\ conversion\ from\ vector\ to\ angle\ with\ atan2}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00039}00039\ \ \ \ \ \textcolor{keywordtype}{float}\ targetAngle\ =\ std::atan2(directionToMouse.y,\ directionToMouse.x)\ *\ 180.f\ /\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_ad00b1e5a061c541252c823ae9925535f_ad00b1e5a061c541252c823ae9925535f}{pi}}\ +\ 90.f;}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00041}00041\ \ \ \ \ \textcolor{comment}{//\ Normalize\ the\ target\ angle\ to\ the\ range\ [0,\ 360]}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00042}00042\ \ \ \ \ \textcolor{keywordflow}{if}\ (targetAngle\ <\ 0)\ targetAngle\ +=\ 360;}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00044}00044\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ current\ angle}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00045}00045\ \ \ \ \ \textcolor{keywordtype}{float}\ currentAngle\ =\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a11e4f9226cb35705bfff3d612ca40e97_a11e4f9226cb35705bfff3d612ca40e97}{getSprite}}().getRotation();}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00047}00047\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ difference\ between\ the\ target\ and\ current\ angle}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00048}00048\ \ \ \ \ \textcolor{keywordtype}{float}\ angleDifference\ =\ targetAngle\ -\/\ currentAngle;}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00050}00050\ \ \ \ \ \textcolor{comment}{//\ Normalize\ the\ angle\ difference\ to\ the\ range\ [-\/180,\ 180]}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00051}00051\ \ \ \ \ \textcolor{keywordflow}{while}\ (angleDifference\ <\ -\/180)\ angleDifference\ +=\ 360;}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{while}\ (angleDifference\ >\ 180)\ angleDifference\ -\/=\ 360;}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00054}00054\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ extra\ rotational\ acceleration\ based\ on\ the\ angle\ difference}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00055}00055\ \ \ \ \ \textcolor{comment}{//\ Also,\ the\ accel\ is\ based\ on\ the\ speed\ of\ the\ ship}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00056}00056\ \ \ \ \ \textcolor{keywordtype}{float}\ accel\ =\ abs(10\ *\ angleDifference\ /\ 180.f\ *\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a079cb2e1a9c29200ed055899c8c85655_a079cb2e1a9c29200ed055899c8c85655}{getSpeed}}()\ /\ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a37172050635246410d20abcaab29b7ca_a37172050635246410d20abcaab29b7ca}{getBaseSpeed}}());}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00058}00058\ \ \ \ \ \textcolor{comment}{//\ Limit\ the\ turning\ speed}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00059}00059\ \ \ \ \ angleDifference\ =\ std::clamp(angleDifference,\ -\/\mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_ae1bf1106191f76bef19ee1de8bfa24c2_ae1bf1106191f76bef19ee1de8bfa24c2}{turningSpeed}},\ \mbox{\hyperlink{class_pirate_game_1_1_player_ship_movement_handler_ae1bf1106191f76bef19ee1de8bfa24c2_ae1bf1106191f76bef19ee1de8bfa24c2}{turningSpeed}});}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00061}00061\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ new\ rotation}}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00062}00062\ \ \ \ \ \mbox{\hyperlink{class_pirate_game_1_1_ship_movement_handler_a11e4f9226cb35705bfff3d612ca40e97_a11e4f9226cb35705bfff3d612ca40e97}{getSprite}}().setRotation(currentAngle\ +\ (accel\ *\ angleDifference));}
\DoxyCodeLine{\Hypertarget{_player_ship_movement_handler___p_g_8cpp_source_l00063}00063\ \}}

\end{DoxyCode}
